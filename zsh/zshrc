#
# Bens zshrc managed in dotfiles
#


parse_git_branch() {
    git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}



set-aws() {
    # Check if exactly one argument is provided
    if [ "$#" -ne 1 ]; then
        echo "Usage: set_aws_profile_and_update <profile_name>"
        return 1
    fi

    # Set the AWS_PROFILE environment variable
    export AWS_PROFILE="$1"
    echo "AWS_PROFILE set to $AWS_PROFILE"

    # Run the updateAws command
    updateAWSLoginCache.py
}


get_aws_profile() {

    updateAWSLoginCache.py > /dev/null 2>&1 &

    # Check if the file exists
    if [[ -f /tmp/aws_current_env ]]; then
        # Read the file's content
        cat /tmp/aws_current_env
    else
        # Return 'ERROR' if the file does not exist
        echo 'ERROR'
    fi

}

setopt PROMPT_SUBST
PROMPT='$(get_aws_profile) %9c%{%F{green}%}$(parse_git_branch)%{%F{none}%} $ '


# PROMPT='%9c%{%F{green}%}$(parse_git_branch)%{%F{none}%} $ '